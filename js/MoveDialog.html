{*<!-- lookup house dialog box 
    Templates that use this must add to their smarty dialog block:
      {include file="js/AddMemberDialog.html"}
    A button to activate it could be:
      <button onClick="lookupMember(title)">Add a household member</button>
    where title is why you are doing the lookup
    Then the php script will have to call addMember($cid, $hid) (in details.php)
  -->*}

<div id="MoveDialog" style="display: none">
<h3 id="MoveInfo"></h3>
<form method="post" id="LookupForm" action="details.php">
  <input type="hidden" name="SelectedMemberID" id="SelectedMemberID">
  <input type="hidden" name="SelectedHouseID" id="SelectedHouseID">
  <input type="hidden" name="buttonAction">
  <table class="edit">
    <tr>
      <td class="label" id="LookupByName">by Household Name</td>
      <td>
        <input id="NameLookup" name="HouseName" value="">
      </td>
    </tr>
    <tr><td>&nbsp;</td></tr>
    <tr>
      <td class="label">by a Member's Name</td>
      <td><input id="MemberLookup" name="MemberName" value=""></td>
    </tr>
  </table>
</form> {* moveMemberForm *}
</div> {* moveMemberDialog *}

{literal}<script>

function moveMemberDialog(title, move_action, contact_id) {
  /* lookup contact from db to add to this household */
  $("#SelectedMemberID").val(contact_id);
  lookupMember(title, move_action,buttonAction="moveMember");
}

function lookupMember(title,form_action,buttonAction="selectHouse") {
  $("#MoveMemberDialog").dialog ({
    height: "auto",
    width: "auto",
    modal: true,
    classes: {"ui-dialog": "no-titlebar"},
    closeOnEscape: true,
    /* title: title, */
    buttons: [
      {
        text: "Cancel",
        click: function() {
          $("#NameLookup").val("");
          $("#NameLookup").autocomplete("destroy");
          $("#MemberLookup").val("");
          $("#MemberLookup").autocomplete("destroy");
          $(this).dialog("destroy");
        }
      }
    ]
  });
  $("#LookupForm").attr("action",form_action);
  $("#MoveInfo").html(title);
  $("#NameLookup").autocomplete({
    minLength: 3,
    source: function(request, response) {
      $.ajax({
        type: "GET",
        url: "ajax/NameLookup.php?value="+$("#NameLookup").val(),
        dataType: "json",
        success: function(res_html, textStatus, xhr) {
          response(res_html);
        },
        error: function(xhr, textStatus, errorThrown) {
          $("#content").html(textStatus+errorThrown);
        }
      })
    },
    select: function(event, ui) {
      //$("#SelectedHouseID").val($("#NameLookup").val());
      $("#SelectedHouseID").val(ui.item.value);
      $("#LookupForm input[name=buttonAction]").val(buttonAction);
      $("#LookupForm").submit();
    }
  });
  $("#MemberLookup").autocomplete({
    minLength: 3,
    source: function(request, response) {
      $.ajax({
        type: "GET",
        url: "ajax/MemberLookup.php?value="+$("#MemberLookup").val(),
        dataType: "json",
        success: function(res_html, textStatus, xhr) {
          response(res_html);
        },
        error: function(xhr, textStatus, errorThrown) {
          $("#content").html(textStatus+errorThrown);
        }
      })
    },
    select: function(event, ui) {
      //$("#SelectedHouseID").val($("#MemberLookup").val());
      $("#SelectedHouseID").val(ui.item.value);
      $("#LookupForm input[name=buttonAction]").val(buttonAction);
      $("#LookupForm").submit();
    }
  });
}
</script>{/literal}