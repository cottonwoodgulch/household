{*<!-- lookup member dialog box 
    Templates that use this must add to their smarty dialog block:
      {include file="js/AddDialog.html"}
    A button to activate it could be:
      <button onClick="lookupMember(title, details.php, 'addMember')">Add a household member</button>
  -->*}

<div id="AddDialog" style="display: none">
<h3 id="AddInfo"></h3>
<form method="post" id="AddForm" action="details.php">
  <input type="hidden" name="AddHouseID" id="AddHouseID">
  <input type="hidden" name="AddContactID" id="AddContactID">
  <input type="hidden" name="buttonAction">
  <table class="edit">
    <tr>
      <td class="label">by a First/Middle/Last Name</td>
      <td><input id="AddMemberLookup" name="AddMemberName" value=""></td>
    </tr>
  </table>
</form> {* addForm *}
</div> {* addDialog *}

{literal}<script>

function lookupMember(title, form_action, buttonAction="addMember") {
  // title: the label on the dialog box (string)
  // form_action: script that receives the data from the dialog (string)
  // buttonAction: the value to put into the buttonAction html field, defaults to "addMember" (string, optional)
  $("#AddDialog").dialog ({
    height: "auto",
    width: "auto",
    modal: true,
    classes: {"ui-dialog": "no-titlebar"},
    closeOnEscape: true,
    buttons: [
      {
        text: "Cancel",
        click: function() {
          $("#AddMemberLookup").val("");
          $("#AddMemberLookup").autocomplete("destroy");
          $(this).dialog("destroy");
        }
      }
    ]
  });
  $("#AddForm").attr("action",form_action);
  $("#AddInfo").html(title);
  $("#AddMemberLookup").autocomplete({
    minLength: 3,
    source: function(request, response) {
      $.ajax({
        type: "GET",
        url: "ajax/AddLookup.php?value="+$("#AddMemberLookup").val(),
        dataType: "json",
        success: function(res_html, textStatus, xhr) {
          response(res_html);
        },
        error: function(xhr, textStatus, errorThrown) {
          $("#content").html(textStatus+errorThrown);
        }
      })
    },
    select: function(event, ui) {
      $("#AddContactID").val(ui.item.value);
      // Customizing the member and household will take some work
      // What we have access to right here is #AddContactID and #AddHouseID
      Confirm(buttonAction, "Really add member to household", "#AddForm");
    }
  });
}
</script>{/literal}